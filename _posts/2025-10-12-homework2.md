---
layout: post
title: "Homework 2 - Analysis of Security Incident Distributions"
---

## Introduction

In this homework, I analyze a dataset of security incidents focusing on three key metrics:
- Incident Duration (minutes)
- Data Leaked (MB)
- Detection Time (hours)

These metrics are crucial for understanding patterns in security breaches and improving response strategies.

<!--more-->

## Methodology

### Data Generation and Storage
To create a realistic dataset, I implemented two Python scripts for data generation and analysis:

<details>
    <summary>View generate_security_data.py</summary>
    {% highlight python linenos %}
    import numpy as np
    import psycopg2
    from datetime import datetime
    from dotenv import load_dotenv
    import os

    load_dotenv()

    db_params = {
        "database": os.getenv('DB_NAME'),
        "user": os.getenv('DB_USER'),
        "password": os.getenv('DB_PASSWORD'),
        "host": os.getenv('DB_HOST'),
        "port": os.getenv('DB_PORT')
    }

    def generate_security_incidents(n_samples=30):
        # Generate incident durations (convert to standard Python int)
        incident_durations = [int(x) for x in np.random.normal(60, 20, n_samples)]
        incident_durations = [max(1, x) for x in incident_durations]
        
        # Generate data leaked (convert to float)
        data_leaked = [float(round(x, 2)) for x in np.random.lognormal(0, 1, n_samples) * 2]
        
        # Generate detection times (convert to float)
        detection_times = [float(round(x, 2)) for x in np.random.exponential(2, n_samples)]
        
        return list(zip(incident_durations, data_leaked, detection_times))

    try:
        conn = psycopg2.connect(**db_params)
        cur = conn.cursor()
        incidents = generate_security_incidents()
        
        for incident in incidents:
            cur.execute("""
                INSERT INTO security_incidents 
                (incident_duration, data_leaked, detection_time)
                VALUES (%s, %s, %s)
            """, incident)
        
        conn.commit()
        print(f"Successfully inserted {len(incidents)} records")

    except Exception as e:
        print(f"Error: {e}")
    finally:
        if conn:
            cur.close()
            conn.close()
    {% endhighlight %}
</details>

<details>
    <summary>View analyze_distributions.py</summary>
    {% highlight python linenos %}
    import numpy as np
    import matplotlib.pyplot as plt
    import seaborn as sns
    import psycopg2
    import pandas as pd
    from sqlalchemy import create_engine
    from dotenv import load_dotenv
    import os

    load_dotenv()

    db_params = {
        "database": os.getenv('DB_NAME'),
        "user": os.getenv('DB_USER'),
        "password": os.getenv('DB_PASSWORD'),
        "host": os.getenv('DB_HOST'),
        "port": os.getenv('DB_PORT')
    }

    def fetch_data():
        engine = create_engine(f'postgresql://{db_params["user"]}:{db_params["password"]}@{db_params["host"]}:{db_params["port"]}/{db_params["database"]}')
        query = "SELECT incident_duration, data_leaked, detection_time FROM security_incidents"
        df = pd.read_sql_query(query, engine)
        return df

    def plot_distributions(df):
        os.makedirs('assets/images', exist_ok=True)

        # Plot Incident Duration
        plt.figure(figsize=(10, 6))
        sns.histplot(data=df, x='incident_duration', kde=True, color='skyblue')
        plt.title('Distribution of Incident Duration')
        plt.xlabel('Duration (minutes)')
        plt.ylabel('Frequency')
        plt.savefig('assets/images/incident_duration.png', dpi=300, bbox_inches='tight')
        plt.close()
        
        # Plot Data Leaked
        plt.figure(figsize=(10, 6))
        sns.histplot(data=df, x='data_leaked', kde=True, color='lightgreen')
        plt.title('Distribution of Data Leaked')
        plt.xlabel('Data Leaked (MB)')
        plt.ylabel('Frequency')
        plt.savefig('assets/images/data_leaked.png', dpi=300, bbox_inches='tight')
        plt.close()
        
        # Plot Detection Time
        plt.figure(figsize=(10, 6))
        sns.histplot(data=df, x='detection_time', kde=True, color='salmon')
        plt.title('Distribution of Detection Time')
        plt.xlabel('Detection Time (hours)')
        plt.ylabel('Frequency')
        plt.savefig('assets/images/detection_time.png', dpi=300, bbox_inches='tight')
        plt.close()

    def main():
        df = fetch_data()
        plot_distributions(df)
        print("\nBasic Statistics:")
        print(df.describe())

    if __name__ == "__main__":
        main()
    {% endhighlight %}
</details>

The implementation follows this approach:

1. **Database Setup**: Created a PostgreSQL table `security_incidents` with columns for incident duration, data leaked, and detection time
2. **Data Generation**: Used NumPy to generate statistically realistic data:
   - Normal distribution for incident durations (mean = 60 minutes, std = 20)
   - Log-normal distribution for data leaks (scaled by factor of 2)
   - Exponential distribution for detection times (rate parameter = 2)
3. **Data Storage**: Utilized SQLAlchemy to efficiently store the generated data
4. **Analysis**: Generated distribution plots using Matplotlib and Seaborn, with kernel density estimation (KDE) curves

The scripts are stored in the project's assets directory and can be examined for implementation details.

### Visualization
The distributions were visualized using Python's Matplotlib and Seaborn libraries, creating histograms with kernel density estimation (KDE) curves to better understand the data patterns.

## Dataset Description and Analysis

The dataset consists of 31 security incidents, each following specific statistical distributions:

### 1. Incident Duration (Normal Distribution)
![Incident Duration Distribution](/assets/images/incident_duration.png)

The incident duration data shows:
- Mean duration: 64.32 minutes
- Standard deviation: 15.29 minutes
- Range: 37 to 99 minutes
- Median (50th percentile): 64 minutes

The distribution appears approximately normal, clustering around the one-hour mark, which aligns with typical security incident patterns.

### 2. Data Leaked (Log-normal Distribution)
![Data Leaked Distribution](/assets/images/data_leaked.png)

The data leaked measurements reveal:
- Mean: 3.81 MB
- Standard deviation: 4.53 MB
- Range: 0.22 to 20.08 MB
- Median: 2.34 MB

The right-skewed distribution indicates that while most breaches involve smaller amounts of data, there are occasional large-scale data leaks, which is typical in real-world scenarios.

### 3. Detection Time (Exponential Distribution)
![Detection Time Distribution](/assets/images/detection_time.png)

Detection time statistics show:
- Mean: 1.26 hours
- Standard deviation: 1.81 hours
- Range: 0.10 to 8.38 hours
- Median: 0.67 hours

The exponential pattern indicates that most incidents are detected relatively quickly, but some take significantly longer, which is consistent with real-world cybersecurity scenarios.

## Statistical Insights

The quartile analysis reveals important operational insights:
- 75% of incidents are resolved within 75.5 minutes
- 75% of data breaches involve less than 4.7 MB of data
- 75% of incidents are detected within 1.07 hours

These metrics provide valuable benchmarks for:
- Setting response time objectives
- Allocating security resources
- Developing incident response strategies

## Conclusion

The statistical analysis reveals patterns that can inform cybersecurity strategies:
1. Incident durations follow a predictable pattern, useful for resource planning
2. Data leaks show a long-tail distribution, highlighting the need for scalable response capabilities
3. Detection times demonstrate the importance of early warning systems

These insights can help organizations better prepare for and respond to security incidents, particularly in allocating resources and setting response time targets.
